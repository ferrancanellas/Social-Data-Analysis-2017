<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>D3 Page Template</title>
	<script type="text/javascript" src="d3/d3.js"></script>
	<style type="text/css">

	</style>
</head>
<body>
	<p id="k2">Click to k2</p>
	<p id="k3">Click to k3</p>
	<p id="k4">Click to k4</p>
	<p id="k5">Click to k5</p>
	<p id="k6">Click to k6</p>

	<script type="text/javascript">
        //Width and height
        var w = 600;
        var h = 550;
        var dataset_points = [];
        var dataset_centers = [];
        var colors = ["deepskyblue", "greenyellow", "blueviolet", "gold", "crimson", "chocolate"]
			//Define map projection
			var projection = d3.geo.mercator()
			.center([-122.433701, 37.767683])
			.scale(190000)
			.translate([w/2, h/2]);

			//Define path generator
			var path = d3.geo.path()
			.projection(projection);

			//Create SVG element
			var svg = d3.select("body")
			.append("svg")
			.attr("width", w)
			.attr("height", h);

			//Load in GeoJSON data
			d3.json("sfpddistricts.geojson", function(json) {
				
				//Bind data and create one path per GeoJSON feature
				svg.selectAll("path")
				.data(json.features)
				.enter()
				.append("path")
				.attr("d", path)
				.style("fill", "gainsboro")
				.style("stroke", "dimgray");
				var layer1 = svg.append('g')
				var layer2 = svg.append('g')
				
				d3.csv("kmeans.csv", function(data) {
					dataset_points = data;
					circles = layer1.selectAll("circle")
					.data(dataset_points)
					.enter()
					.append("circle")
					.attr("cx", function(d) {
						return projection([d.lon, d.lat])[0];
					})
					.attr("cy", function(d) {
						return projection([d.lon, d.lat])[1];
					})
					.attr("r", 2)

					circles.style("fill", function(d) {
						return colors[parseInt(d.l2)];
					});

				});

				d3.csv("centers.csv", function(centers){
					dataset_centers = centers;
					centroids = layer2.selectAll("circle")
					.data(dataset_centers)
					.enter()
					.append("circle")
					.attr("cx", function(d) {
						return projection([d.lon, d.lat])[0];
					})
					.attr("cy", function(d) {
						return projection([d.lon, d.lat])[1];
					})
					.attr("r", 5)
					.style("stroke", "black")
					.style("fill", function(d){return colors[d.color];})
					.style("fill-opacity", function(d){
						if (d.k == "2") {return "1";}
						else {return "0";}
					})
					.style("stroke-opacity", function(d){
						if (d.k == "2") {return "1";}
						else {return "0";}
					});
				}); 

				d3.selectAll("p")
				.on("click", function() {
					var paragraphID = d3.select(this).attr("id");

					if (paragraphID == "k2") {
						circles.style("fill", function(d) {return colors[parseInt(d.l2)];});
						centroids.style("fill-opacity", function(d){
							if (d.k == "2") {return "1";}
							else {return "0";}
						})
						.style("stroke-opacity", function(d){
							if (d.k == "2") {return "1";}
							else {return "0";}

						});
					}
					else if (paragraphID == "k3") {
						circles.style("fill", function(d) {return colors[parseInt(d.l3)];});
						centroids.style("fill-opacity", function(d){
							if (d.k == "3") {return "1";}
							else {return "0";}
						})
						.style("stroke-opacity", function(d){
							if (d.k == "3") {return "1";}
							else {return "0";}

						});
					}
					else if (paragraphID == "k4") {
						circles.style("fill", function(d) {return colors[parseInt(d.l4)];});
						centroids.style("fill-opacity", function(d){
							if (d.k == "4") {return "1";}
							else {return "0";}
						})
						.style("stroke-opacity", function(d){
							if (d.k == "4") {return "1";}
							else {return "0";}

						});
					}
					else if (paragraphID == "k5") {
						circles.style("fill", function(d) {return colors[parseInt(d.l5)];});
						centroids.style("fill-opacity", function(d){
							if (d.k == "5") {return "1";}
							else {return "0";}
						})
						.style("stroke-opacity", function(d){
							if (d.k == "5") {return "1";}
							else {return "0";}

						});
					}
					else if (paragraphID == "k6") {
						circles.style("fill", function(d) {return colors[parseInt(d.l6)];});
						centroids.style("fill-opacity", function(d){
							if (d.k == "6") {return "1";}
							else {return "0";}
						})
						.style("stroke-opacity", function(d){
							if (d.k == "6") {return "1";}
							else {return "0";}

						});
					}

					
				});
			});


		</script>
	</body>
	</html>
